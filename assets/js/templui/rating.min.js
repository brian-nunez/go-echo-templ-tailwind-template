(()=>{typeof window.ratingState>"u"&&(window.ratingState=new WeakMap);(function(){function h(t){if(!t||t.hasAttribute("data-initialized"))return;t.setAttribute("data-initialized","true");let u=window.ratingState.get(t);u&&M(t,u),t.setAttribute("data-tui-rating-initialized","true");let i={value:parseFloat(t.getAttribute("data-tui-rating-initial-value"))||0,precision:parseFloat(t.getAttribute("data-tui-rating-precision"))||1,readonly:t.getAttribute("data-tui-rating-readonly")==="true",name:t.getAttribute("data-tui-rating-name")||"",onlyInteger:t.getAttribute("data-tui-rating-onlyinteger")==="true",maxValue:0},d=t.querySelector("[data-tui-rating-input]"),s=Array.from(t.querySelectorAll("[data-tui-rating-item]")),r=i.value,o=0,f={click:V,mouseover:S,mouseleave:x};function p(){let a=0;for(let e of s){let n=parseInt(e.getAttribute("data-tui-rating-value"),10);!isNaN(n)&&n>a&&(a=n)}i.maxValue=Math.max(1,a),r=Math.max(0,Math.min(i.maxValue,r)),r=Math.round(r/i.precision)*i.precision,v()}function v(){d&&(d.value=r.toFixed(2))}function c(a){for(let e of s){let n=parseInt(e.getAttribute("data-tui-rating-value"),10);if(isNaN(n))continue;let y=e.querySelector("[data-tui-rating-item-foreground]");if(!y)continue;let l=a>0?a:r,w=n<=Math.floor(l),A=!w&&n-1<l&&l<n,N=A?(l-Math.floor(l))*100:0;y.style.width=w?"100%":A?`${N}%`:"0%"}}function I(a){if(i.readonly)return;let e=a;i.onlyInteger?e=Math.round(e):r===e&&e%1===0?e=Math.max(0,e-i.precision):e=Math.round(e/i.precision)*i.precision,r=Math.max(0,Math.min(i.maxValue,e)),o=0,v(),c(0),t.dispatchEvent(new CustomEvent("rating-change",{bubbles:!0,detail:{name:i.name,value:r,maxValue:i.maxValue}})),d&&(d.dispatchEvent(new Event("input",{bubbles:!0})),d.dispatchEvent(new Event("change",{bubbles:!0})))}function S(a){if(i.readonly)return;let e=a.target.closest("[data-tui-rating-item]");e&&(o=parseInt(e.getAttribute("data-tui-rating-value"),10),isNaN(o)||c(o))}function x(){i.readonly||(o=0,c(0))}function V(a){if(i.readonly)return;let e=a.target.closest("[data-tui-rating-item]");if(!e)return;let n=parseInt(e.getAttribute("data-tui-rating-value"),10);isNaN(n)||I(n)}if(p(),c(0),i.readonly){t.style.cursor="default";for(let a of s)a.style.cursor="default"}else t.addEventListener("click",f.click),t.addEventListener("mouseover",f.mouseover),t.addEventListener("mouseleave",f.mouseleave);let b=t.closest("form");b&&b.addEventListener("reset",()=>{r=i.value,o=0,v(),c(0)});let g=new MutationObserver(()=>{try{t.querySelectorAll("[data-tui-rating-item]").length!==s.length&&(s=Array.from(t.querySelectorAll("[data-tui-rating-item]")),p(),c(o>0?o:0))}catch(a){console.error("Error in rating MutationObserver:",a)}});g.observe(t,{childList:!0,subtree:!0});let L={handlers:f,observer:g,items:s};window.ratingState.set(t,L)}function M(t,u){!t||!u||(!t.getAttribute("data-tui-rating-readonly")==="true"&&(t.removeEventListener("click",u.handlers.click),t.removeEventListener("mouseover",u.handlers.mouseover),t.removeEventListener("mouseleave",u.handlers.mouseleave)),u.observer&&u.observer.disconnect(),window.ratingState.delete(t),t.removeAttribute("data-tui-rating-initialized"))}function m(t=document){t instanceof Element&&t.matches("[data-tui-rating-component]")&&h(t),t&&typeof t.querySelectorAll=="function"&&t.querySelectorAll("[data-tui-rating-component]:not([data-initialized])").forEach(h)}window.templUI=window.templUI||{},window.templUI.rating={init:m},document.addEventListener("DOMContentLoaded",()=>m())})();})();
